col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
corr = cor(Variable_df[idx,c(col_y,col_X)])
idx = abs(corr[,col_y])>.05
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
idx = abs(corr[,col_y])>.1
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
corr = cor(Variable_df[!idx,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
corr = cor(Variable_df[!idx,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
idx_clu_1
idx_clu_1 = Variable_df$Cluster == 1
corr = cor(Variable_df[idx_clu_1,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
corr = cor(Variable_df[idx_clu_1,c(col_y,col_X)])
idx_clu_1
corr = cor(Variable_df[idx_clu_1,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
idx
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
idx_clu_1
Variable_df[idx_clu_1,c(col_y,col_X)]
Variable_df[idx_clu_1,c(col_y,col_X)]
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Ele_stu_den" ,   "Junior_stu_den" ,"Senior_stu_den", "Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
arrange(Variable_df[c("COUNTYNAME","TOWNNAME","VILLNAME",col_y)], Nr)
idx_clu_1 = Variable_df$Cluster == 1
pdf_plot(Variable_df$Nr[!idx_clu_1])+xlab("density of Nr(Cluster is 2,3,4 都市化較低)")
pdf_plot(Variable_df$Nr[idx_clu_1])+xlab("density of Nr (Cluster is 1 都市化較高)")
corr = cor(Variable_df[idx_clu_1,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
corr = cor(Variable_df[idx_clu_1,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y))
corr = cor(Variable_df[!idx_clu_1,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr[idx,idx]
for(i in c('Hospital',  "Temple",  "School", "Train.stat",  "Clinic","Ele_stu", "Junior_stu" ,"Senior_stu", "Train.crow", "Nr")){
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$P_CNT
Variable_df[i_new] = Variable_df[i]/Variable_df$P_CNT
}
colnames(Variable_df)
corr = cor(Variable_df[idx_clu_1,c("Nr_den",col_X)])
idx = abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr")
corr = cor(Variable_df[idx_clu_1,c("Nr_den",col_X)])
idx = abs(corr[,col_y])>.1
idx = abs(corr[,"Nr_den"])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr")
corr[col_X_den,col_X_den]
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr")
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr = cor(Variable_df[idx_clu_1,c("Nr_den",col_X)])
idx = abs(corr[,"Nr_den"])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr")
corr[col_X_den,col_X_den]
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr_den")
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", "Nr_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
col_y_den =c('Nr_den')
idx = abs(corr[,col_y_den])>.1 | abs(corr[,col_y])>.1
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Ele_stu_den" ,   "Junior_stu_den" ,"Senior_stu_den", "Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
idx = abs(corr[,col_y_den])>.1 | abs(corr[,col_y])>.1
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.1 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,c(col_y,col_y_den)]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y))
col_X_02
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y))
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y))
corr = cor(Variable_df[!idx_clu_1,c(col_y,col_X)])
idx = abs(corr[,col_y])>.1
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y]) %>% tail(-1)
corr = cor(Variable_df[!idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
for(i in c('Hospital',  "Temple",  "School", "Train.stat",  "Clinic","Ele_stu", "Junior_stu" ,"Senior_stu", "Train.crow", "Nr")){
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$Area_sqkm
Variable_df[i_new] = Variable_df[i]/Variable_df$Area_sqkm
}
colnames(Variable_df)
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Ele_stu_den" ,   "Junior_stu_den" ,"Senior_stu_den", "Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
arrange(Variable_df[c("COUNTYNAME","TOWNNAME","VILLNAME",col_y)], Nr)
idx_clu_1 = Variable_df$Cluster == 1
pdf_plot(Variable_df$Nr[!idx_clu_1])+xlab("density of Nr(Cluster is 2,3,4 都市化較低)")
pdf_plot(Variable_df$Nr[idx_clu_1])+xlab("density of Nr (Cluster is 1 都市化較高)")
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y_den))
c(col_X_02,col_y_den)
col_X_02
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
col_X_02
ggpairs(Variable_df, columns =c(col_X_02,col_y_den))
sum(Variable_df$Nr[!idx_clu_1]==0)
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1)
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1); sum(Variable_df$Nr[idx_clu_1]==0)/sum(idx_clu_1);
Variable_df$Nr[idx_clu_1]
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1); sum(Variable_df$Nr[idx_clu_1]==0)/sum(idx_clu_1); sum(Variable_df$Nr==0)/nrow(Variable_df)
idx_clu_1 = Variable_df$Cluster == 1
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1); sum(Variable_df$Nr[idx_clu_1]==0)/sum(idx_clu_1); sum(Variable_df$Nr==0)/nrow(Variable_df)
corr[col_X_den,col_X_den]
corr[idx,idx]
for(i in c('Hospital',  "Temple",  "School", "Train.stat",  "Clinic","Ele_stu", "Junior_stu" ,"Senior_stu", "Train.crow")){
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$P_CNT
Variable_df[i_new] = Variable_df[i]/Variable_df$P_CNT
}
colnames(Variable_df)
colnames(Variable_df)
for(i in c('Hospital',  "Temple",  "School", "Train.stat",  "Clinic","Ele_stu", "Junior_stu" ,"Senior_stu", "Train.crow")){
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$P_CNT
Variable_df[i_new] = Variable_df[i]/Variable_df$P_CNT
}
colnames(Variable_df)
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Ele_stu_den" ,   "Junior_stu_den" ,"Senior_stu_den", "Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
col_y_den
idx_clu_1 = Variable_df$Cluster == 1
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y_den))
Variable_shp@data["Nr_den"] = Variable_shp@data["Nr"]/Variable_shp@data$Area_sqkm
Variable_df["Nr_den"] = Variable_df["Nr"]/Variable_df$Area_sqkm
colnames(Variable_df)
for(i in c('Hospital',  "Temple",  "School", "Train.stat",  "Clinic","Ele_stu", "Junior_stu" ,"Senior_stu", "Train.crow")){
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$P_CNT
Variable_df[i_new] = Variable_df[i]/Variable_df$P_CNT
}
Variable_shp@data["Nr_den"] = Variable_shp@data["Nr"]/Variable_shp@data$Area_sqkm
Variable_df["Nr_den"] = Variable_df["Nr"]/Variable_df$Area_sqkm
colnames(Variable_df)
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Ele_stu_den" ,   "Junior_stu_den" ,"Senior_stu_den", "Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
idx_clu_1 = Variable_df$Cluster == 1
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1); sum(Variable_df$Nr[idx_clu_1]==0)/sum(idx_clu_1); sum(Variable_df$Nr==0)/nrow(Variable_df)
pdf_plot(Variable_df$Nr[!idx_clu_1])+xlab("density of Nr(Cluster is 2,3,4 都市化較低)")
pdf_plot(Variable_df$Nr[idx_clu_1])+xlab("density of Nr (Cluster is 1 都市化較高)")
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
corr = cor(Variable_df[!idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.1 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y))
pdf_plot(Variable_df$Hospital)
pdf_plot(Variable_df$Clinic)
sum(Variable_df$Clinic == 0)/ length(Variable_df$Clinic)
point_Plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x))+
theme_bw()
return(g)
}
Point_Plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x))+
theme_bw()
return(g)
}
pdf_plot <- function(x){
g = ggplot()+
geom_histogram(aes(x = x, y = ..density..),
fill = '#557C55', alpha = 0.8)+
geom_density(aes(x = x, y = ..density..),
color = '#062C30', size = 1)+
theme_bw()
return(g)
}
Point_Plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x))+
theme_bw()
return(g)
}
pdf_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x))+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7))+
theme_bw()
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7))+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
theme_bw()
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
??scale_color_brewer
??palette
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_brewer(palette = 'Greens')+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_distiller(palette = 'Greens')+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_distiller(type="div")+
theme_bw()
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_distiller(type="div")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_distiller(palette = "Spectral")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_distiller(palette = "Blues")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_color_distiller(palette = "Blues",end=0)+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .7, size = x))+
scale_colour_gradient(low = "#E9EFC0", high = "#4E944F")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .85, size = x))+
scale_colour_gradient(low = "#E9EFC0", high = "#4E944F")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, alpha = .85, size = x))+
scale_colour_gradient(low = "#E9EFC0", high = "#005555")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, size = x))+
scale_colour_gradient(low = "#E9EFC0", high = "#005555")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
pdf_plot <- function(x){
g = ggplot()+
geom_histogram(aes(x = x, y = ..density..),
fill = '#557C55', alpha = 0.8)+
geom_density(aes(x = x, y = ..density..),
color = '#062C30', size = 1)
return(g)
}
point_plot(Variable_df$Clinic)
pdf_plot <- function(x){
g = ggplot()+
geom_histogram(aes(x = x, y = ..density..),
fill = '#557C55', alpha = 0.8)+
geom_density(aes(x = x, y = ..density..),
color = '#062C30', size = 1)+
theme_bw()
return(g)
}
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, size = x))+
scale_colour_gradient(low = "#E9EFC0", high = "#005555")
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, size = x))+
scale_colour_gradient(low = "#83BD75", high = "#005555")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
point_plot <- function(x){
g = ggplot()+
geom_point(aes(x = Variable_df$X, y = Variable_df$Y, color = x, size = x))+
scale_colour_gradient(low = "#83BD75", high = "#1A3C40")+
theme_bw()
return(g)
}
point_plot(Variable_df$Clinic)
Variable_shp@data[i] = sapply(Variable_shp@data[i], function(x) as.numeric(x))
Variable_df[i] = sapply(Variable_df[i], function(x) as.numeric(x))
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$P_CNT
Variable_df[i_new] = Variable_df[i]/Variable_df$P_CNT
for(i in c('Hospital',  "Temple",  "School", "Train.stat",  "Clinic","Ele_stu", "Junior_stu" ,"Senior_stu", "Train.crow")){
i_new = paste0(i, "_den")
Variable_shp@data[i_new] = Variable_shp@data[i]/Variable_shp@data$P_CNT
Variable_df[i_new] = Variable_df[i]/Variable_df$P_CNT
}
Variable_shp@data["Nr_den"] = Variable_shp@data["Nr"]/Variable_shp@data$Area_sqkm
Variable_df["Nr_den"] = Variable_df["Nr"]/Variable_df$Area_sqkm
colnames(Variable_df)
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Ele_stu_den" ,   "Junior_stu_den" ,"Senior_stu_den", "Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
arrange(Variable_df[c("COUNTYNAME","TOWNNAME","VILLNAME",col_y)], Nr)
idx_clu_1 = Variable_df$Cluster == 1
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1); sum(Variable_df$Nr[idx_clu_1]==0)/sum(idx_clu_1); sum(Variable_df$Nr==0)/nrow(Variable_df)
pdf_plot(Variable_df$Nr[!idx_clu_1])+xlab("density of Nr(Cluster is 2,3,4 都市化較低)")
pdf_plot(Variable_df$Nr[idx_clu_1])+xlab("density of Nr (Cluster is 1 都市化較高)")
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
corr = cor(Variable_df[!idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.1 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y))
col_X =
c("Hospital_den" ,  "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
# for (i in col_X[col_X != "Cluster"]){
#
#     Variable_df[i] <- scale(Variable_df[i])
#     Variable_shp@data[i] <-scale(Variable_shp@data[i])
#
# }
idx_clu_1 = Variable_df$Cluster == 1
sum(Variable_df$Nr[!idx_clu_1]==0)/sum(!idx_clu_1); sum(Variable_df$Nr[idx_clu_1]==0)/sum(idx_clu_1); sum(Variable_df$Nr==0)/nrow(Variable_df)
pdf_plot(Variable_df$Nr[!idx_clu_1])+xlab("density of Nr(Cluster is 2,3,4 都市化較低)")
pdf_plot(Variable_df$Nr[idx_clu_1])+xlab("density of Nr (Cluster is 1 都市化較高)")
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
col_X =
c( "Temple_den",  "School_den", "Train.stat_den",  "Clinic_den", # 公共建設
"Train.crow_den",
"M_F_RAT",  "YOUN_DEP", # 人口統計(教育程度、人口密度...)
"Income_mea","Income_sta")
col_y= c('Nr')
col_y_den =c('Nr_den')
corr = cor(Variable_df[idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.05 | abs(corr[,col_y])>.05
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-2)
corr[idx,idx]
ggpairs(Variable_df, columns =c(col_X_02,col_y_den))
corr = cor(Variable_df[!idx_clu_1,c(col_y, col_y_den,col_X)])
idx = abs(corr[,col_y_den])>.1 | abs(corr[,col_y])>.1
col_X_den = c("Temple_den",  "School_den", "Train.stat_den",  "Clinic_den")
corr[col_X_den,col_X_den]
col_X_02 = names(corr[idx,col_y_den]) %>% tail(-1)
corr[idx,idx]
